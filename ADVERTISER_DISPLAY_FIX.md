# ุฏููู ุฅุตูุงุญ ูุดููุฉ ุนุฏู ุธููุฑ ุงููุนูููู

## ๐ ุงููุดููุฉ

ุนูุฏ ุฅุถุงูุฉ ูุนูู ุฌุฏูุฏ ูู ูุทุงุน ููู ุงูุนูุด ููุฏููุฉ ุฌุฏุฉุ ูุง ูุธูุฑ ุงููุนูู ุนูู ุงูุตูุญุฉ [https://prokr.net/movers/jeddah](https://prokr.net/movers/jeddah) ุนูู ุงูุฑุบู ูู ุญูุธู ูู Google Sheets ููุงุนุฏุฉ ุงูุจูุงูุงุช.

## ๐ฏ ุงูุณุจุจ ุงูุฌุฐุฑู

ุงููุนูู ูุง ูุธูุฑ ูุฃูู ููุชูุฏ ุฅูู ุงูุญููู ุงูุชุงููุฉ ูู Firebase:
- **sector**: ูุฌุจ ุฃู ูููู `movers` (ุฃู ุงููุทุงุน ุงูููุงุณุจ)
- **coverage_type**: ูุฌุจ ุฃู ูููู `city` ุฃู `kingdom` ุฃู `both`
- **coverage_cities**: ุฅุฐุง ูุงู `coverage_type` ูู `city`ุ ูุฌุจ ุฃู ูุญุชูู ุนูู `['jeddah']`

ุจุงูุฅุถุงูุฉ ุฅูู ุฐููุ ุญุงูุฉ ุงูุงุดุชุฑุงู ูุฌุจ ุฃู ุชููู `active` (ูููุณ `pending_payment`).

## ๐ ุดุฑูุท ุธููุฑ ุงููุนูู ุนูู ุตูุญุฉ ุฌุฏุฉ

ููู ูุธูุฑ ุงููุนูู ุนูู ุตูุญุฉ `https://prokr.net/movers/jeddah`ุ ูุฌุจ ุชููุฑ ุฌููุน ุงูุดุฑูุท ุงูุชุงููุฉ:

### 1. ุจูุงูุงุช ุงููุนูู ูู Firebase
```javascript
{
  "status": "active",               // โ ุงูุญุงูุฉ ูุดุทุฉ
  "sector": "movers",               // โ ูุทุงุน ููู ุงูุนูุด
  "coverage_type": "city",          // โ ููุน ุงูุชุบุทูุฉ
  "coverage_cities": ["jeddah"]     // โ ุงููุฏู (ูุญุชูู ุนูู ุฌุฏุฉ)
}
```

**ุฃู**:
```javascript
{
  "status": "active",
  "sector": "movers",
  "coverage_type": "kingdom"        // โ ุชุบุทูุฉ ุงูููููุฉ (ูุธูุฑ ูู ุฌููุน ุงููุฏู)
}
```

**ุฃู**:
```javascript
{
  "status": "active",
  "sector": "movers",
  "coverage_type": "both",          // โ ุชุบุทูุฉ ุงูููููุฉ ูุงููุฏู
  "coverage_cities": ["jeddah", "riyadh"]
}
```

### 2. ุงูุงุดุชุฑุงู ุงููุดุท
```javascript
{
  "status": "active",               // โ ุญุงูุฉ ุงูุงุดุชุฑุงู ูุดุทุฉ
  "coverage_area": "city",          // โ ููุน ุงูุชุบุทูุฉ
  "city": "jeddah",                 // โ ุงููุฏููุฉ
  "end_date": "2025-12-26"          // โ ูู ููุชูู ุจุนุฏ
}
```

## ๐๏ธ ุงูุญููู

### ุงูุญู 1: ุงุณุชุฎุฏุงู ุณูุฑูุจุช ุงูุชุดุฎูุต ุงูุดุงูู

```bash
node scripts/diagnose-advertiser-display.js
```

ูุฐุง ุงูุณูุฑูุจุช ุณูููู ุจู:
- โ ูุญุต ุฌููุน ุงููุนูููู ุงููุดุทูู
- โ ุนุฑุถ ุงููุนูููู ุญุณุจ ุงููุทุงุน
- โ ุนุฑุถ ุงููุนูููู ุงูุฐูู ูุฌุจ ุฃู ูุธูุฑูุง ูู ุฌุฏุฉ
- โ ูุญุต ุขุฎุฑ ูุนูู ุชู ุฅุถุงูุชู
- โ ุงูุชุญูู ูู ุดุฑูุท ุงูุธููุฑ
- โ ุนุฑุถ ุญุงูุฉ ุงูุงุดุชุฑุงูุงุช

### ุงูุญู 2: ุฅุตูุงุญ ุขุฎุฑ ูุนูู ุชููุงุฆูุงู

```bash
node scripts/fix-latest-advertiser.js
```

ูุฐุง ุงูุณูุฑูุจุช ุณูููู ุจู:
- โ ุฌูุจ ุขุฎุฑ ูุนูู ุชู ุฅุถุงูุชู
- โ ุฅุถุงูุฉ ุงูุญููู ุงูููููุฏุฉ ุชููุงุฆูุงู:
  - `sector: "movers"`
  - `coverage_type: "city"`
  - `coverage_cities: ["jeddah"]`
- โ ุชุญุฏูุซ ุญุงูุฉ ุงูุงุดุชุฑุงู ูู `pending_payment` ุฅูู `active`
- โ ุฅุถุงูุฉ `coverage_area` ู `city` ููุงุดุชุฑุงู

### ุงูุญู 3: ุงูุชุญูู ูู ุฌููุน ุงููุนูููู

```bash
node scripts/prevent-missing-fields.js
```

ูุฐุง ุงูุณูุฑูุจุช ุณูููู ุจู:
- โ ูุญุต ุฌููุน ุงููุนูููู ูู ุงููุธุงู
- โ ุนุฑุถ ุงููุนูููู ุงูุฐูู ููุชูุฏูู ุญููู ูุทููุจุฉ
- โ ุฅุนุทุงุก ุชูุฑูุฑ ุดุงูู ุนู ุงูุญุงูุฉ

## ๐ง ุงูุฅุตูุงุญ ุงููุฏูู

ุฅุฐุง ููุช ุชูุถู ุงูุฅุตูุงุญ ุงููุฏููุ ุงุชุจุน ุงูุฎุทูุงุช ุงูุชุงููุฉ:

### 1. ูู Firebase Console

ุงูุชูู ุฅูู `advertisers` collection ูุญุฏูุซ ุงููุนูู:

```javascript
{
  "sector": "movers",
  "coverage_type": "city",
  "coverage_cities": ["jeddah"]
}
```

### 2. ุชุญุฏูุซ ุงูุงุดุชุฑุงู

ุงูุชูู ุฅูู `subscriptions` collection ูุญุฏูุซ ุงูุงุดุชุฑุงู:

```javascript
{
  "status": "active",
  "coverage_area": "city",
  "city": "jeddah"
}
```

## ๐ ุขููุฉ ุงูููุชุฑุฉ ูู ุงูููุฏ

### ูู API Endpoint (`/api/advertisers`)

```javascript
// ููุชุฑุฉ ุญุณุจ ุงููุฏููุฉ
if (city) {
  advertisers = advertisers.filter(adv => {
    // ุงููุนูููู ุงูุฐูู ูุบุทูู ุงูููููุฉ ุจุงููุงูู
    if (adv.coverage_type === 'kingdom') return true;
    // ุงููุนูููู ุงูุฐูู ูุบุทูู ุงูููููุฉ ูุงููุฏููุฉ
    if (adv.coverage_type === 'both') return true;
    // ุงููุนูููู ุงูุฐูู ูุบุทูู ูุฐู ุงููุฏููุฉ ููุท
    if (adv.coverage_type === 'city' && adv.coverage_cities?.includes(city as string)) return true;
    return false;
  });
}
```

### ูู ุตูุญุฉ ุฌุฏุฉ (`pages/movers/jeddah.tsx`)

```javascript
const response = await axios.get('/api/advertisers', {
  params: {
    status: 'active',
    sector: 'movers',
    city: 'jeddah'
  }
});

const kingdomAdvertisers = response.data.filter((adv: any) => 
  adv.sector === 'movers' && (
    adv.coverage_type === 'kingdom' || 
    adv.coverage_type === 'both' ||
    (adv.coverage_type === 'city' && adv.coverage_cities?.includes('jeddah'))
  )
);
```

## โ ุงูุชุญูู ูู ุงูุญู

ุจุนุฏ ุชุทุจูู ุงูุฅุตูุงุญุ ุชุฃูุฏ ูู:

1. โ ุงููุนูู ูุธูุฑ ูู Firebase Console ุจุงูุญููู ุงูุตุญูุญุฉ
2. โ ุงูุงุดุชุฑุงู ุญุงูุชู `active`
3. โ ุชุญุฏูุซ ุงูุตูุญุฉ (Ctrl + F5) ุนูู [https://prokr.net/movers/jeddah](https://prokr.net/movers/jeddah)
4. โ ุงููุนูู ูุธูุฑ ุจุดูู ุตุญูุญ

## ๐ ุงูููุงูุฉ ูู ุงููุดููุฉ ูุณุชูุจูุงู

### ูู ุตูุญุฉ ุฅุถุงูุฉ ุงููุนูู (`/admin/advertisers/new`)

ุชุฃูุฏ ูู:
- โ ุงุฎุชูุงุฑ ุงููุทุงุน ูู `SectorSelector`
- โ ุงุฎุชูุงุฑ ุงูุชุบุทูุฉ ุงูุฌุบุฑุงููุฉ ูู `CoverageAndPackageSelector`
- โ ุงุฎุชูุงุฑ ุงููุฏููุฉ (ุฅุฐุง ูุงู `coverage_type` ูู `city`)
- โ ุฅุถุงูุฉ ุจุงูุฉ ูุงุญุฏุฉ ุนูู ุงูุฃูู

### ุงูููุฏ ูููู ุจู:

```javascript
const advertiserData = {
  sector: selectedSector,              // โ ูู SectorSelector
  coverage_type: coverageType,         // โ ูุญุณูุจ ูู ุงูุจุงูุงุช
  coverage_cities: selectedCities,     // โ ูู ุงูุจุงูุงุช ุงููุญุฏุฏุฉ
  packages: selectedPackages           // โ ุงูุจุงูุงุช ุงููุฎุชุงุฑุฉ
};
```

## ๐ ููุงุญุธุงุช ูููุฉ

1. **Google Sheets** ููุณุชุฎุฏู ููุฃุฑุดูุฉ ููุทุ ูููุณ ูุตุฏุฑ ุงูุจูุงูุงุช ูููููุน
2. **Firebase** ูู ูุตุฏุฑ ุงูุจูุงูุงุช ุงููุนูู ูููููุน
3. ูุฌุจ ุฃู ุชุชุทุงุจู ุงูุจูุงูุงุช ูู Firebase ูุน ุงูุดุฑูุท ุงููุฐููุฑุฉ ุฃุนูุงู
4. ุญุงูุฉ ุงูุงุดุชุฑุงู ูุฌุจ ุฃู ุชููู `active` ูุธููุฑ ุงููุนูู

## ๐ ุฑูุงุจุท ูููุฏุฉ

- ุตูุญุฉ ุฌุฏุฉ: [https://prokr.net/movers/jeddah](https://prokr.net/movers/jeddah)
- ุตูุญุฉ ุงูุฑูุงุถ: [https://prokr.net/movers/riyadh](https://prokr.net/movers/riyadh)
- ุตูุญุฉ ุงูุฏูุงู: [https://prokr.net/movers/dammam](https://prokr.net/movers/dammam)
- ุตูุญุฉ ุงูููููุฉ: [https://prokr.net/movers](https://prokr.net/movers)

---

ุชู ุฅูุดุงุก ูุฐุง ุงูุฏููู ูู: ููููุจุฑ 2025
ุขุฎุฑ ุชุญุฏูุซ: 26 ููููุจุฑ 2025

