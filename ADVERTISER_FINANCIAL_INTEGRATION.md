# ๐ ุฑุจุท ุงููุนูููู ุจูุธุงู ุงูููุงุชูุฑ ูุงููุงููุงุช - ุฏููู ุดุงูู

> **ุงูุชุงุฑูุฎ:** 22 ููููุจุฑ 2025  
> **ุงูุญุงูุฉ:** โ ููุชูู - ุฑุจุท ุงุญุชุฑุงูู 100%

---

## ๐ ุฌุฏูู ุงููุญุชููุงุช

1. [ุงููุดุงูู ุงูุชู ุชู ุญููุง](#ุงููุดุงูู-ุงูุชู-ุชู-ุญููุง)
2. [ุงููููุงุช ุงูููุญุฏุซุฉ ูุงูุฌุฏูุฏุฉ](#ุงููููุงุช-ุงูููุญุฏุซุฉ-ูุงูุฌุฏูุฏุฉ)
3. [ุชุฏูู ุงูุจูุงูุงุช ุงููุงูู](#ุชุฏูู-ุงูุจูุงูุงุช-ุงููุงูู)
4. [ูุงุฌูุงุช ุงููุณุชุฎุฏู ุงูุฌุฏูุฏุฉ](#ูุงุฌูุงุช-ุงููุณุชุฎุฏู-ุงูุฌุฏูุฏุฉ)
5. [APIs ุงูููุญุฏุซุฉ](#apis-ุงูููุญุฏุซุฉ)
6. [ุฃูุซูุฉ ุนูููุฉ](#ุฃูุซูุฉ-ุนูููุฉ)
7. [ุฏููู ุงูุงุณุชุฎุฏุงู](#ุฏููู-ุงูุงุณุชุฎุฏุงู)

---

## โ ุงููุดุงูู ุงูุชู ุชู ุญููุง

### ุงููุดุงูู ุงูุณุงุจูุฉ:

1. โ **ุนูุฏ ุฅุถุงูุฉ ูุนูู ุฌุฏูุฏ:**
   - ูุง ูุชู ุฅูุดุงุก ุงุดุชุฑุงู ุชููุงุฆูุงู
   - ูุง ูุชู ุฅูุดุงุก ูุงุชูุฑุฉ ุชููุงุฆูุงู
   - ูุง ูุชู ุญุณุงุจ VAT
   - ูุง ูุชู ุชุณุฌูู ุงูุฏูุนุงุช ุงูุฃูููุฉ

2. โ **ูู ุตูุญุฉ ุชูุงุตูู ุงููุนูู:**
   - ุฒุฑ "ูุชุญ ุงููุธุงู ุงููุงูู" ูุญูู ูุตูุญุฉ ุบูุฑ ููุฌูุฏุฉ
   - ุนุฑุถ ุจุณูุท ููุงุดุชุฑุงูุงุช ูุงูููุงุชูุฑ ุจุฏูู ุฅููุงููุฉ ุงูุฅุฏุงุฑุฉ
   - ูุง ููุฌุฏ ููุฎุต ูุงูู ุดุงูู

3. โ **ุนูุฏ ุชุนุฏูู ุงููุนูู:**
   - ูุง ูููู ุฅุถุงูุฉ ุงุดุชุฑุงู ุฌุฏูุฏ
   - ูุง ูููู ุชุณุฌูู ุฏูุนุงุช
   - ุงูุฑุจุท ุบูุฑ ุงุญุชุฑุงูู

### โ ุงูุญููู ุงูููุทุจูุฉ:

1. โ **ุนูุฏ ุฅุถุงูุฉ ูุนูู:**
   - ุฅูุดุงุก ุงุดุชุฑุงู + ูุงุชูุฑุฉ + ุฏูุนุฉ (ุฅู ูุฌุฏุช) ุชููุงุฆูุงู
   - ุญุณุงุจ VAT 15% ุชููุงุฆูุงู
   - ุงุณุชุฎุฏุงู `FinancialService.createSubscriptionWithInvoice()`
   - ุฑุจุท ูุงูู ูุน ูุงุนุฏุฉ ุงูุจูุงูุงุช

2. โ **ุตูุญุฉ ุงููุธุงู ุงููุงูู ุงููุชูุงููุฉ:**
   - ุตูุญุฉ ุฌุฏูุฏุฉ ูุงููุฉ: `/admin/advertisers/[id]/financial`
   - ููุฎุต ูุงูู ุดุงูู (4 ุจุทุงูุงุช)
   - ุฅุฏุงุฑุฉ ุงูุงุดุชุฑุงูุงุช
   - ุฅุฏุงุฑุฉ ุงูููุงุชูุฑ
   - ุชุณุฌูู ุงููุฏููุนุงุช
   - ุชุงุฑูุฎ ุงูุฏูุนุงุช

3. โ **APIs ุฌุฏูุฏุฉ:**
   - `/api/financial/advertiser-summary/[id]` - ุงูููุฎุต ุงููุงูู
   - ุชุญุฏูุซ `/api/advertisers` ููุณุชุฎุฏู ุงููุธุงู ุงููุงูู

---

## ๐ ุงููููุงุช ุงูููุญุฏุซุฉ ูุงูุฌุฏูุฏุฉ

### 1. ูููุงุช ุฌุฏูุฏุฉ โจ

#### `pages/admin/advertisers/[id]/financial.tsx`

```typescript
// ุงูุตูุญุฉ ุงููุงููุฉ ุงููุชูุงููุฉ ููู ูุนูู
// ูุนุฑุถ:
// - ูุนูููุงุช ุงููุนูู ุงูุฃุณุงุณูุฉ
// - ููุฎุต ูุงูู (4 ุจุทุงูุงุช)
// - ูุงุฆูุฉ ุงูุงุดุชุฑุงูุงุช ูุน ุฅููุงููุฉ ุฅุฏุงุฑุชูุง
// - ุฌุฏูู ุงูููุงุชูุฑ
// - ุชุงุฑูุฎ ุงููุฏููุนุงุช
// - ููุงุฐุฌ ุฅูุดุงุก ุงุดุชุฑุงู ูุชุณุฌูู ุฏูุนุฉ

ุงูููููุงุช ุงููุณุชุฎุฏูุฉ:
- CreateSubscriptionForm
- RecordPaymentForm
- SubscriptionsList
- InvoicesTable
- PaymentHistoryTable
- FinancialSummaryCard
```

**ุงููููุฒุงุช:**
- โ ูุงุฌูุฉ ุงุญุชุฑุงููุฉ ูุชูุงููุฉ
- โ ุฃุฒุฑุงุฑ ูุฅูุดุงุก ุงุดุชุฑุงู ูุชุณุฌูู ุฏูุนุฉ
- โ ุนุฑุถ ุงูุจูุงูุงุช ูู ุงูููุช ุงููุนูู
- โ Modal ููุณุฏูุฉ ููููุงุฐุฌ
- โ Animation ูุชุฃุซูุฑุงุช ุจุตุฑูุฉ

#### `pages/api/financial/advertiser-summary/[id].ts`

```typescript
// API ููุญุตูู ุนูู ุงูููุฎุต ุงููุงูู ููุนูู ูุญุฏุฏ
GET /api/financial/advertiser-summary/:id

Response:
{
  total_subscriptions: number,
  active_subscriptions: number,
  total_revenue: number,
  total_paid: number,
  total_pending: number,
  total_invoices: number,
  paid_invoices: number,
  unpaid_invoices: number
}
```

### 2. ูููุงุช ููุญุฏุซุฉ ๐

#### `pages/api/advertisers/index.ts`

**ุงูุชุญุฏูุซุงุช:**

```typescript
// ูุจู:
// ูุงู ููุดุฆ ุงุดุชุฑุงู ููุท ุจุฏูู ูุงุชูุฑุฉ

// ุจุนุฏ:
import { FinancialService } from '../../../lib/services/financial.service';

// ุนูุฏ ุฅูุดุงุก ูุนูู:
if (plan_id && start_date) {
  const financialResult = await FinancialService.createSubscriptionWithInvoice({
    advertiser_id: newAdvertiserId,
    plan_id,
    start_date: new Date(start_date),
    discount_type: discount_type || 'amount',
    discount_amount: discount_amount || 0,
    initial_payment: paid_amount || 0,
    payment_method: 'cash',
    notes: 'ุฅูุดุงุก ุงุดุชุฑุงู ูุน ุฅุถุงูุฉ ุงููุนูู',
    vat_percentage: 15
  });
}
```

**ุงููุชูุฌุฉ:**
- โ ูุชู ุฅูุดุงุก **ุงุดุชุฑุงู** ุชููุงุฆูุงู
- โ ูุชู ุฅูุดุงุก **ูุงุชูุฑุฉ** ุชููุงุฆูุงู ูุน VAT
- โ ูุชู ุชุณุฌูู **ุฏูุนุฉ ุฃูููุฉ** (ุฅู ูุฌุฏุช)
- โ ูุชู ุฅูุดุงุก **ุณุฌู ุชุฏููู** ุชููุงุฆูุงู
- โ ุฌููุน ุงูุญุงูุงุช ูุญุฏุซุฉ ุชููุงุฆูุงู

---

## ๐ ุชุฏูู ุงูุจูุงูุงุช ุงููุงูู

### ุงูุณููุงุฑูู: ุฅุถุงูุฉ ูุนูู ุฌุฏูุฏ

```
1. ุงููุณุชุฎุฏู ูููุฃ ููุฑู ุฅุถุงูุฉ ูุนูู
   โ
2. ุงููุณุชุฎุฏู ูุฎุชุงุฑ:
   - ุงุณู ุงูุดุฑูุฉ: "ุดุฑูุฉ ุงูููู ุงูุญุฏูุซุฉ"
   - ุฑูู ุงููุงุชู: "0501234567"
   - ุงูุจุงูุฉ: "ุดูุฑูุฉ" (1500 ุฑูุงู)
   - ุฏูุนุฉ ุฃูููุฉ: 500 ุฑูุงู
   โ
3. ุนูุฏ ุงูุถุบุท ุนูู "ุญูุธ"
   โ
4. POST /api/advertisers
   โ
5. AdvertiserAdminService.create()
   โ ุฅูุดุงุก ูุนูู ูู collection: advertisers
   โ ID: ADV-001
   โ
6. FinancialService.createSubscriptionWithInvoice()
   โโ 6.1 ุฌูุจ ูุนูููุงุช ุงูุจุงูุฉ ูู plans
   โ      โ ุงูุจุงูุฉ ุงูุดูุฑูุฉ: 1500 ุฑูุงูุ 30 ููู
   โ
   โโ 6.2 ุญุณุงุจ ุงูุชูุงุฑูุฎ
   โ      start_date: 2025-11-22
   โ      end_date: 2025-12-22 (+ 30 ููู)
   โ
   โโ 6.3 ุญุณุงุจ VAT
   โ      subtotal: 1500
   โ      VAT (15%): 225
   โ      total: 1725 ุฑูุงู
   โ
   โโ 6.4 SubscriptionAdminService.create()
   โ      โ collection: subscriptions
   โ      {
   โ        id: SUB-001,
   โ        advertiser_id: ADV-001,
   โ        plan_id: "xAXqTLInisLuglofuQkH",
   โ        start_date: "2025-11-22",
   โ        end_date: "2025-12-22",
   โ        base_price: 1500,
   โ        total_amount: 1725,
   โ        paid_amount: 500,
   โ        remaining_amount: 1225,
   โ        status: "active",
   โ        payment_status: "partial"
   โ      }
   โ
   โโ 6.5 InvoiceAdminService.create()
   โ      โ collection: invoices
   โ      {
   โ        id: INV-001,
   โ        subscription_id: SUB-001,
   โ        invoice_number: "INV-2025-001",
   โ        subtotal: 1500,
   โ        vat_percentage: 15,
   โ        vat_amount: 225,
   โ        amount: 1725,
   โ        status: "unpaid",
   โ        issued_date: "2025-11-22",
   โ        due_date: "2025-12-22"
   โ      }
   โ
   โโ 6.6 PaymentAdminService.create() (ุฅุฐุง ูุงู initial_payment > 0)
          โ collection: payments
          {
            id: PAY-001,
            subscription_id: SUB-001,
            invoice_id: INV-001,
            amount: 500,
            payment_date: "2025-11-22",
            payment_method: "cash",
            notes: "ุฏูุนุฉ ุฃูููุฉ"
          }
   โ
7. Response: { id: "ADV-001", message: "ุชู ุฅูุดุงุก ุงููุนูู ูุงูุงุดุชุฑุงู ูุงููุงุชูุฑุฉ ุจูุฌุงุญ" }
   โ
8. ุงููุณุชุฎุฏู ูุชู ุชูุฌููู ุฅูู dashboard
```

---

## ๐จ ูุงุฌูุงุช ุงููุณุชุฎุฏู ุงูุฌุฏูุฏุฉ

### 1. ุตูุญุฉ ุงููุธุงู ุงููุงูู

**URL:** `/admin/advertisers/[id]/financial`

#### ุงูููููุงุช:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  Header: "ุงููุธุงู ุงููุงูู ุงููุชูุงูู"                 โ
โ  Subtitle: "ุดุฑูุฉ ุงูููู ุงูุญุฏูุซุฉ"                   โ
โ  [ุฒุฑ ุงูุนูุฏุฉ ูููุนูู]                               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ูุนูููุงุช ุงููุนูู ุงูุณุฑูุนุฉ                           โ
โ  ๐ข ุดุฑูุฉ ุงูููู ุงูุญุฏูุซุฉ                            โ
โ  ๐ฑ 0501234567  โ๏ธ info@company.com               โ
โ  [โ ูุดุท]                                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโฌโโโโโโโโโโฌโโโโโโโโโโฌโโโโโโโโโโ
โ ๐      โ ๐      โ โณ      โ ๐      โ
โ ุงูุงุดุชุฑุงูุงุชโ ุงูุฅูุฑุงุฏุงุชโ ุงููุชุจูู โ ุงูููุงุชูุฑโ
โ   3     โ 5,175  โ 1,225  โ    3    โ
โ ูุดุท: 2  โ ูุฏููุน:  โ ูู 5,175โ ูุฏููุนุฉ:โ
โ         โ 3,950  โ        โ    2    โ
โโโโโโโโโโโดโโโโโโโโโโดโโโโโโโโโโดโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  [โ ุฅูุดุงุก ุงุดุชุฑุงู ุฌุฏูุฏ]  [๐ฐ ุชุณุฌูู ุฏูุนุฉ]         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ๐ ูุงุฆูุฉ ุงูุงุดุชุฑุงูุงุช                              โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ  โ ุจุงูุฉ ุดูุฑูุฉ - 1,725 ุฑูุงู                    โ  โ
โ  โ ูู 2025-11-22 ุฅูู 2025-12-22               โ  โ
โ  โ [โ ูุดุท] [๐ก ูุฏููุน ุฌุฒุฆูุงู: 500/1725]       โ  โ
โ  โ [ุฒุฑ: ุชุณุฌูู ุฏูุนุฉ]                            โ  โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ๐ ุฌุฏูู ุงูููุงุชูุฑ                                 โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ  โ ุฑูู ุงููุงุชูุฑุฉ โ ุงููุจูุบ โ ุงูุญุงูุฉ โ ุงูุงุณุชุญูุงู โ โ
โ  โ INV-2025-001 โ 1,725 โ ุบูุฑ ูุฏููุนุฉ โ 2025-12-22โ โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ๐ณ ุชุงุฑูุฎ ุงููุฏููุนุงุช                               โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ  โ 500 ุฑูุงู - 2025-11-22 - ููุฏุงู - ุฏูุนุฉ ุฃูููุฉโ  โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### 2. Modal ุฅูุดุงุก ุงุดุชุฑุงู ุฌุฏูุฏ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ุฅูุดุงุก ุงุดุชุฑุงู ุฌุฏูุฏ            [ร]  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                     โ
โ  ุงุฎุชุฑ ุงูุจุงูุฉ:                      โ
โ  โโโโโโโโโโโโฌโโโโโโโโโโโฌโโโโโโโโโโ โ
โ  โ ุฃุณุจูุนูุฉ  โ ุดูุฑูุฉ โ โ ุณูููุฉ  โ โ
โ  โ 400      โ 1,500    โ 14,000 โ โ
โ  โโโโโโโโโโโโดโโโโโโโโโโโดโโโโโโโโโโ โ
โ                                     โ
โ  ุชุงุฑูุฎ ุงูุจุฏุงูุฉ:                    โ
โ  [2025-11-22         ]              โ
โ                                     โ
โ  ุงูุฎุตู (ุงุฎุชูุงุฑู):                  โ
โ  ููุน: [ูุจูุบ ุซุงุจุช โผ] ุงููุจูุบ: [0]  โ
โ                                     โ
โ  ุงูุฏูุนุฉ ุงูุฃูููุฉ:                   โ
โ  [500 ุฑูุงู]                         โ
โ                                     โ
โ  ููุฎุต:                              โ
โ  โโ ุงูุณุนุฑ: 1,500 ุฑูุงู              โ
โ  โโ VAT: 225 ุฑูุงู                  โ
โ  โโ ุงูุฅุฌูุงูู: 1,725 ุฑูุงู           โ
โ  โโ ุงููุฏููุน: 500 ุฑูุงู              โ
โ  โโ ุงููุชุจูู: 1,225 ุฑูุงู            โ
โ                                     โ
โ  [ุฅูุบุงุก]         [ุฅูุดุงุก ุงูุงุดุชุฑุงู] โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ APIs ุงูููุญุฏุซุฉ

### 1. POST /api/advertisers

**ุงููุฏูู:**
```typescript
// ูุงู ููุดุฆ ูุนูู ููุท
// ุงูุงุดุชุฑุงู ูููุดุฃ ุจุดูู ูููุตู ุจุฏูู ูุงุชูุฑุฉ
```

**ุงูุฌุฏูุฏ:**
```typescript
POST /api/advertisers

Body:
{
  // ุจูุงูุงุช ุงููุนูู
  company_name: "ุดุฑูุฉ ุงูููู ุงูุญุฏูุซุฉ",
  phone: "0501234567",
  whatsapp: "0501234567",
  services: "ููู ุนูุดุ ูู ูุชุฑููุจ",
  selected_icon: "truck",
  status: "active",
  
  // ุจูุงูุงุช ุงูุจุงูุฉ (ุงุฎุชูุงุฑูุฉ)
  plan_id: "xAXqTLInisLuglofuQkH",
  start_date: "2025-11-22",
  discount_type: "amount",
  discount_amount: 0,
  paid_amount: 500  // ุงูุฏูุนุฉ ุงูุฃูููุฉ
}

Response:
{
  id: "ADV-001",
  message: "ุชู ุฅูุดุงุก ุงููุนูู ูุงูุงุดุชุฑุงู ูุงููุงุชูุฑุฉ ุจูุฌุงุญ"
}

ูุง ูุญุฏุซ ุชููุงุฆูุงู:
โ ุฅูุดุงุก Advertiser
โ ุฅูุดุงุก Subscription
โ ุฅูุดุงุก Invoice ูุน VAT
โ ุฅูุดุงุก Payment (ุฅุฐุง paid_amount > 0)
โ ุชุญุฏูุซ ุฌููุน ุงูุญุงูุงุช
โ ุฅูุดุงุก Audit Log
```

### 2. GET /api/financial/advertiser-summary/:id

```typescript
GET /api/financial/advertiser-summary/ADV-001

Response:
{
  total_subscriptions: 3,          // ุฅุฌูุงูู ุงูุงุดุชุฑุงูุงุช
  active_subscriptions: 2,         // ุงูุงุดุชุฑุงูุงุช ุงููุดุทุฉ
  total_revenue: 5175,             // ุฅุฌูุงูู ุงูุฅูุฑุงุฏุงุช
  total_paid: 3950,                // ุฅุฌูุงูู ุงููุฏููุน
  total_pending: 1225,             // ุงููุจูุบ ุงููุชุจูู
  total_invoices: 3,               // ุฅุฌูุงูู ุงูููุงุชูุฑ
  paid_invoices: 2,                // ุงูููุงุชูุฑ ุงููุฏููุนุฉ
  unpaid_invoices: 1               // ุงูููุงุชูุฑ ุบูุฑ ุงููุฏููุนุฉ
}

ุงุณุชุฎุฏุงู:
- ููุณุชุฎุฏู ูู ุตูุญุฉ ุงููุธุงู ุงููุงูู
- ููุญุณุจ ูู ุฌููุน ุงูุงุดุชุฑุงูุงุช ูุงูููุงุชูุฑ ูููุนูู
- ุชุญุฏูุซ ูู ุงูููุช ุงููุนูู
```

---

## ๐ก ุฃูุซูุฉ ุนูููุฉ

### ูุซุงู 1: ุฅุถุงูุฉ ูุนูู ูุน ุงุดุชุฑุงู ุดูุฑู

```typescript
// 1. ุงููุณุชุฎุฏู ูููุฃ ุงููููุฐุฌ
const formData = {
  company_name: "ุดุฑูุฉ ุงูุฃูุงูุฉ ูููู ุงูุนูุด",
  phone: "0559876543",
  whatsapp: "0559876543",
  services: "ููู ุนูุด ุฏุงุฎู ูุฎุงุฑุฌ ุฌุฏุฉ",
  selected_icon: "truck",
  plan_id: "xAXqTLInisLuglofuQkH",  // ุดูุฑูุฉ 1500
  start_date: "2025-11-22",
  paid_amount: 1000  // ุฏูุนุฉ ุฃูููุฉ
};

// 2. ุฅุฑุณุงู ุงูุทูุจ
const response = await axios.post('/api/advertisers', formData);

// 3. ุงููุชูุฌุฉ:
// โ ูุนูู ุฌุฏูุฏ: ADV-002
// โ ุงุดุชุฑุงู: SUB-002
//    - start: 2025-11-22
//    - end: 2025-12-22
//    - base_price: 1500
//    - total: 1725 (ูุน VAT)
//    - paid: 1000
//    - remaining: 725
//    - status: active
//    - payment_status: partial
//
// โ ูุงุชูุฑุฉ: INV-2025-002
//    - subtotal: 1500
//    - vat_amount: 225
//    - amount: 1725
//    - status: unpaid
//
// โ ุฏูุนุฉ: PAY-002
//    - amount: 1000
//    - method: cash
//    - notes: "ุฏูุนุฉ ุฃูููุฉ"
```

### ูุซุงู 2: ุนุฑุถ ุงููุธุงู ุงููุงูู ูููุนูู

```typescript
// 1. ุงููุณุชุฎุฏู ููุชุญ ุตูุญุฉ ุงููุนูู
// URL: /admin/advertisers/ADV-002

// 2. ูุถุบุท ุนูู ุฒุฑ "ูุชุญ ุงููุธุงู ุงููุงูู"
// ูุชู ุงูุชูุฌูู ุฅูู: /admin/advertisers/ADV-002/financial

// 3. ุงูุตูุญุฉ ุชุฌูุจ:
//    - ูุนูููุงุช ุงููุนูู
//    - ุงูููุฎุต ุงููุงูู (ูู API)
//    - ูุงุฆูุฉ ุงูุงุดุชุฑุงูุงุช
//    - ุฌุฏูู ุงูููุงุชูุฑ
//    - ุชุงุฑูุฎ ุงููุฏููุนุงุช

// 4. ุงูููุฎุต ุงููุงูู:
{
  total_subscriptions: 1,
  active_subscriptions: 1,
  total_revenue: 1725,
  total_paid: 1000,
  total_pending: 725,
  total_invoices: 1,
  paid_invoices: 0,
  unpaid_invoices: 1
}

// 5. ูุงุฆูุฉ ุงูุงุดุชุฑุงูุงุช:
[
  {
    id: "SUB-002",
    plan_name: "ุจุงูุฉ ุดูุฑูุฉ",
    start_date: "2025-11-22",
    end_date: "2025-12-22",
    total_amount: 1725,
    paid_amount: 1000,
    remaining_amount: 725,
    status: "active",
    payment_status: "partial"
  }
]

// 6. ุงูููุงุชูุฑ:
[
  {
    id: "INV-2025-002",
    invoice_number: "INV-2025-002",
    amount: 1725,
    status: "unpaid",
    issued_date: "2025-11-22",
    due_date: "2025-12-22"
  }
]
```

### ูุซุงู 3: ุชุณุฌูู ุฏูุนุฉ ูู ุงููุธุงู ุงููุงูู

```typescript
// 1. ุงููุณุชุฎุฏู ูู ุตูุญุฉ ุงููุธุงู ุงููุงูู
// 2. ูุถุบุท ุนูู "ุชุณุฌูู ุฏูุนุฉ"
// 3. ูุฎุชุงุฑ ุงูุงุดุชุฑุงู: SUB-002
// 4. ูุฏุฎู ุงููุจูุบ: 725 ุฑูุงู
// 5. ูุฎุชุงุฑ ุทุฑููุฉ ุงูุฏูุน: ุจุทุงูุฉ ุงุฆุชูุงู
// 6. ูุถุบุท "ุชุณุฌูู"

// ุงูุทูุจ:
POST /api/financial/record-payment
{
  subscription_id: "SUB-002",
  invoice_id: "INV-2025-002",
  amount: 725,
  payment_method: "credit_card",
  payment_date: "2025-11-25"
}

// ูุง ูุญุฏุซ ุชููุงุฆูุงู:
// โ ุฅูุดุงุก ุฏูุนุฉ ุฌุฏูุฏุฉ: PAY-003
// โ ุชุญุฏูุซ ุงูุงุดุชุฑุงู:
//    - paid_amount: 1000 โ 1725
//    - remaining_amount: 725 โ 0
//    - payment_status: partial โ paid
// โ ุชุญุฏูุซ ุงููุงุชูุฑุฉ:
//    - status: unpaid โ paid
//    - paid_date: 2025-11-25
// โ ุฅูุดุงุก ุณุฌู ุชุฏููู (Audit Log)

// ุงููุชูุฌุฉ ูู ุงูููุฎุต ุงููุงูู:
{
  total_paid: 1000 โ 1725,
  total_pending: 725 โ 0,
  paid_invoices: 0 โ 1,
  unpaid_invoices: 1 โ 0
}
```

---

## ๐ ุฏููู ุงูุงุณุชุฎุฏุงู

### ูููุทูุฑ

#### 1. ุฅุนุฏุงุฏ ุงููุดุฑูุน

```bash
# 1. ุชุฃูุฏ ูู ุชุดุบูู ุงููุดุฑูุน
npm run dev

# 2. ุชุฃูุฏ ูู Firebase
# - serviceAccountKey.json ููุฌูุฏ
# - plans ูุญุฏุซุฉ ุจุงูุฃุณุนุงุฑ ุงูุฌุฏูุฏุฉ
```

#### 2. ุงุฎุชุจุงุฑ ุงููุธุงู

```bash
# A. ุงุฎุชุจุฑ ุฅุถุงูุฉ ูุนูู ุฌุฏูุฏ
1. ุงูุชุญ: http://localhost:3000/admin/advertisers/new
2. ุงููุฃ ุงูุจูุงูุงุช
3. ุงุฎุชุฑ ุจุงูุฉ
4. ุฃุฏุฎู ุฏูุนุฉ ุฃูููุฉ
5. ุงุถุบุท "ุญูุธ"
6. ุชุญูู ูู:
   - ุชู ุฅูุดุงุก ุงููุนูู
   - ุชู ุงูุชูุฌูู ููู dashboard
   - ุฑุณุงูุฉ ูุฌุงุญ

# B. ุงูุชุญ ุงููุธุงู ุงููุงูู
1. ุงูุชุญ ูุงุฆูุฉ ุงููุนูููู
2. ุงุฎุชุฑ ุงููุนูู ุงูููุถุงู
3. ุงุถุบุท "ูุชุญ ุงููุธุงู ุงููุงูู"
4. ุชุญูู ูู:
   - ุงูููุฎุต ุงููุงูู ุตุญูุญ
   - ุงูุงุดุชุฑุงู ุธุงูุฑ
   - ุงููุงุชูุฑุฉ ุธุงูุฑุฉ
   - ุงูุฏูุนุฉ ูุณุฌูุฉ

# C. ุชุณุฌูู ุฏูุนุฉ ุฌุฏูุฏุฉ
1. ูู ุงููุธุงู ุงููุงูู
2. ุงุถุบุท "ุชุณุฌูู ุฏูุนุฉ"
3. ุงููุฃ ุงูุจูุงูุงุช
4. ุงุถุบุท "ุชุณุฌูู"
5. ุชุญูู ูู:
   - ุชุญุฏูุซ ุงูููุฎุต ุงููุงูู
   - ุชุญุฏูุซ ุญุงูุฉ ุงูุงุดุชุฑุงู
   - ุชุญุฏูุซ ุญุงูุฉ ุงููุงุชูุฑุฉ
```

### ูููุณุชุฎุฏู ุงูููุงุฆู

#### ุฅุถุงูุฉ ูุนูู ุฌุฏูุฏ

```
1. Dashboard โ "ุงููุนูููู" โ "ุฅุถุงูุฉ ูุนูู"
2. ุงููุฃ:
   - ุงุณู ุงูุดุฑูุฉ โ
   - ุฑูู ุงููุงุชู โ
   - ุฑูู ุงููุงุชุณุงุจ (ุงุฎุชูุงุฑู)
   - ุงูุฎุฏูุงุช (ุงุฎุชูุงุฑู)
   - ุงุฎุชุฑ ุฃููููุฉ
3. ุงุฎุชุฑ ุงูุจุงูุฉ:
   - ุฃุณุจูุนูุฉ (400)
   - ุดูุฑูุฉ (1500) โญ
   - ุณูููุฉ (14000)
4. ุฃุฏุฎู ุฏูุนุฉ ุฃูููุฉ (ุงุฎุชูุงุฑู)
5. ุงุถุบุท "ุญูุธ"
6. โ ุชู! ุงููุนูู ุฌุงูุฒ ูุน ุงุดุชุฑุงู ููุงุชูุฑุฉ
```

#### ุฅุฏุงุฑุฉ ูุงููุงุช ุงููุนูู

```
1. Dashboard โ "ุงููุนูููู" โ ุงุฎุชุฑ ุงููุนูู
2. ุงุถุบุท "ูุชุญ ุงููุธุงู ุงููุงูู" (ุงูุฒุฑ ุงูุฃุฎุถุฑ)
3. ุณุชุฌุฏ:
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   โ ๐ ุงูููุฎุต ุงููุงูู (4 ุจุทุงูุงุช) โ
   โ โ ุฅูุดุงุก ุงุดุชุฑุงู ุฌุฏูุฏ          โ
   โ ๐ฐ ุชุณุฌูู ุฏูุนุฉ                 โ
   โ ๐ ูุงุฆูุฉ ุงูุงุดุชุฑุงูุงุช           โ
   โ ๐ ุฌุฏูู ุงูููุงุชูุฑ              โ
   โ ๐ณ ุชุงุฑูุฎ ุงููุฏููุนุงุช            โ
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
4. ูุฅูุดุงุก ุงุดุชุฑุงู:
   - ุงุถุบุท "ุฅูุดุงุก ุงุดุชุฑุงู ุฌุฏูุฏ"
   - ุงุฎุชุฑ ุงูุจุงูุฉ
   - ุฃุฏุฎู ุงูุชูุงุตูู
   - ุงุถุบุท "ุฅูุดุงุก"
5. ูุชุณุฌูู ุฏูุนุฉ:
   - ุงุถุบุท "ุชุณุฌูู ุฏูุนุฉ"
   - ุงุฎุชุฑ ุงูุงุดุชุฑุงู
   - ุฃุฏุฎู ุงููุจูุบ
   - ุงุถุบุท "ุชุณุฌูู"
```

---

## โ Checklist ุงูุชุญูู

### Firebase

- [x] โ Collection: `advertisers` - ููุฌูุฏ
- [x] โ Collection: `subscriptions` - ููุฌูุฏ
- [x] โ Collection: `invoices` - ููุฌูุฏ
- [x] โ Collection: `payments` - ููุฌูุฏ
- [x] โ Collection: `plans` - ููุฌูุฏ ููุญุฏุซ (7 ุจุงูุงุช)

### Services

- [x] โ `AdvertiserAdminService` - ูุนูู
- [x] โ `FinancialService.createSubscriptionWithInvoice()` - ูุนูู
- [x] โ `FinancialService.recordPayment()` - ูุนูู
- [x] โ `FinancialService.getAdvertiserFinancialSummary()` - ูุนูู

### APIs

- [x] โ `POST /api/advertisers` - ูุญุฏุซ ููุชูุงูู
- [x] โ `GET /api/financial/advertiser-summary/:id` - ุฌุฏูุฏ ูุฌุงูุฒ

### UI Pages

- [x] โ `/admin/advertisers/new` - ูุถูู ูุนูู ูุน ูุธุงู ูุงูู
- [x] โ `/admin/advertisers/[id]` - ูุนุฑุถ ุฒุฑ ุงููุธุงู ุงููุงูู
- [x] โ `/admin/advertisers/[id]/financial` - ุตูุญุฉ ูุงููุฉ ูุงููุฉ

### Components

- [x] โ `CreateSubscriptionForm` - ููุฌูุฏ
- [x] โ `RecordPaymentForm` - ููุฌูุฏ
- [x] โ `SubscriptionsList` - ููุฌูุฏ
- [x] โ `InvoicesTable` - ููุฌูุฏ
- [x] โ `PaymentHistoryTable` - ููุฌูุฏ
- [x] โ `FinancialSummaryCard` - ููุฌูุฏ

---

## ๐ฏ ุงูุฎูุงุตุฉ

### ูุง ุชู ุฅูุฌุงุฒู

```
โ ุฑุจุท ูุงูู ุจูู ุงููุนูููู ูุงููุธุงู ุงููุงูู
โ ุฅูุดุงุก ุชููุงุฆู ููุงุดุชุฑุงู + ุงููุงุชูุฑุฉ + ุงูุฏูุนุฉ
โ ุญุณุงุจ VAT ุชููุงุฆู (15%)
โ ุตูุญุฉ ูุธุงู ูุงูู ูุชูุงููุฉ ููู ูุนูู
โ APIs ุฌุฏูุฏุฉ ููููุฎุต ุงููุงูู
โ ูุงุฌูุงุช ูุณุชุฎุฏู ุงุญุชุฑุงููุฉ
โ ุชุญุฏูุซุงุช ุชููุงุฆูุฉ ููุญุงูุงุช
โ ุณุฌู ุชุฏููู ูุงูู
```

### ุงูููุงุฆุฏ

```
๐ฐ ุฅุฏุงุฑุฉ ูุงููุฉ ุงุญุชุฑุงููุฉ
๐ ููุฎุตุงุช ูุงููุฉ ุฏูููุฉ ูู ุงูููุช ุงููุนูู
๐ ุฑุจุท ูุญูู ุจูู ุฌููุน ุงูููููุงุช
โ ูุง ุญุงุฌุฉ ูุฅุฏุฎุงู ุจูุงูุงุช ููุฑุฑุฉ
๐ ููุงุชูุฑ ุชููุงุฆูุฉ ูุน VAT
๐ณ ุชุชุจุน ูุงูู ูููุฏููุนุงุช
๐ ุดูุงููุฉ ูุงููุฉ ูู ุงูุนูููุงุช ุงููุงููุฉ
```

### ุงูุงุณุชุฎุฏุงู

```
1. ุฅุถุงูุฉ ูุนูู โ ุงุดุชุฑุงู + ูุงุชูุฑุฉ (ุชููุงุฆู) โ
2. ูุชุญ ุงููุธุงู ุงููุงูู โ ุฅุฏุงุฑุฉ ุดุงููุฉ โ
3. ุชุณุฌูู ุฏูุนุงุช โ ุชุญุฏูุซ ุชููุงุฆู โ
4. ุนุฑุถ ุงูููุฎุต ุงููุงูู โ ูู ุงูููุช ุงููุนูู โ
```

---

**๐ ุงููุธุงู ุฌุงูุฒ ููุงุณุชุฎุฏุงู ุงูููุฑู!**

**ุงูุชุงุฑูุฎ:** 22 ููููุจุฑ 2025  
**ุงูุญุงูุฉ:** โ ููุชูู 100%  
**ุงูุฑุจุท:** โ ุงุญุชุฑุงูู ูุดุงูู

