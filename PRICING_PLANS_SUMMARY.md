# ملخص نظام إدارة خطط الأسعار

## ما تم إنجازه:

### 1. صفحة إدارة خطط الأسعار الجديدة
- **المسار**: `/admin/plans`
- **المميزات**:
  - إضافة خطة جديدة
  - تعديل الخطط الموجودة
  - حذف الخطط
  - تفعيل/تعطيل الخطط
  - عرض جميع المميزات لكل خطة

### 2. تحديث APIs
- **GET /api/plans**: جلب جميع الخطط (عام)
- **POST /api/plans**: إضافة خطة جديدة (للمدير فقط)
- **PUT /api/plans/[id]**: تعديل خطة (للمدير فقط)
- **DELETE /api/plans/[id]**: حذف خطة (للمدير فقط)

### 3. تكامل Firebase
- حماية عمليات الكتابة بـ Admin Authentication
- السماح بالقراءة العامة للخطط
- إضافة fallback queries للتعامل مع الفهرسة

### 4. تحسينات على الصفحات الموجودة

#### صفحة "أعلن لدينا" (/advertise):
- عرض الخطط بشكل احترافي مع الأيقونات والألوان
- دعم المميزات كـ array أو string
- إمكانية اختيار الخطة قبل إرسال الطلب

#### صفحة إضافة معلن جديد (/admin/advertisers/new):
- عرض الخطط المتاحة مع المميزات
- إمكانية اختيار خطة محددة أو تخصيص المدة
- عرض أول 3 مميزات لكل خطة

### 5. الأمان والصلاحيات
- جميع عمليات إدارة الخطط تتطلب تسجيل دخول المدير
- التحقق من الـ token في جميع عمليات التعديل
- حماية البيانات الحساسة

## كيفية استخدام النظام:

### للمدير:
1. تسجيل الدخول من `/admin/login`
2. الذهاب إلى لوحة التحكم
3. النقر على "خطط الأسعار" في القائمة العلوية
4. إضافة/تعديل/حذف الخطط حسب الحاجة

### للعملاء:
1. زيارة صفحة "أعلن معنا" من الصفحة الرئيسية
2. اختيار الخطة المناسبة
3. ملء البيانات وإرسال الطلب

## البيانات المطلوبة لكل خطة:
- **الاسم**: اسم الخطة (مثل: الخطة الأساسية)
- **الوصف**: وصف مختصر للخطة
- **السعر**: بالريال السعودي
- **المدة**: بالأيام (افتراضياً 30 يوم)
- **المميزات**: قائمة بمميزات الخطة
- **الحالة**: نشط/غير نشط

## إضافة خطط افتراضية:
يمكنك إضافة الخطط من خلال:
1. واجهة الإدارة في `/admin/plans`
2. أو مباشرة من Firebase Console باتباع التعليمات في `scripts/add-plans-via-firebase.md`

## الملفات المحدثة:
- `pages/admin/plans.tsx` - صفحة إدارة الخطط
- `pages/api/plans/index.ts` - API للخطط
- `pages/api/plans/[id].ts` - API لخطة محددة
- `pages/admin/dashboard.tsx` - إضافة رابط الخطط
- `pages/advertise.tsx` - تحسين عرض الخطط
- `pages/admin/advertisers/new.tsx` - عرض الخطط عند إضافة معلن
- `lib/services/plan.service.ts` - إضافة fallback queries